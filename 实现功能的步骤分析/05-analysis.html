<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>

<body>
    <script>
        /*
            一. 实现修改密码
               (1) 点击修改密码,发送请求
                  因为button默认为submit,会提交,所以要阻止事件默认行为e.prevemtDefault
                  注意要判断,若旧密码为空或新密码为空或确认密码为空要提示,以及确认密码和新密码不一致要提示
                -- 处理之后,发送请求,参数为旧密码和新密码
               (2) 服务器接收请求
                  ① 获取到旧密码和新密码
                  ② 从session中取出登录密码,判断旧密码和登录密码是否一致,如果不一致返回'旧密码不正确请重新输入'
                  ③ 连接数据库修改操作,返回结果
               (3) 浏览器接收响应体,修改密码成功之后,跳转到doLogOut.php(退出操作,之后会跳转到登陆页面)

            二. 实现分类目录显示
               (1) 一打开页面,发送请求到getCategory.php,将接收的响应体填充模板
               
            三. 实现新增分类
               (1) 点击添加按钮,发送请求,参数为文本框中填入的内容
               (2) 服务器接收请求,获取传递过去的数据,进行数据库添加操作
               (3) 浏览器接收响应体ok,刷新当前页面location.reload()
            
            四. 实现点击某行的编辑按钮,编辑部分显示该行的分类信息
               (1) 因为每一行的编辑按钮都是动态生成的,所以将代码封装成函数,
                   给编辑按钮添加行内事件即调用函数editTr(参数为该行的id)
               (2) 因为分类列表和编辑分类在同一个页面,而分类列表已经通过请求拿到了分类的所有数据
                   所以不用发送请求到服务器
               (3) 声明一个全局变量,用来存储分类请求中接收的响应体(分类的所有信息)
               (4) 在函数中遍历所有分类数据,如果某条数据的id==参数id(即要编辑的这一行的id)
                    就将这一行的各数据填到相应位置,注意添加按钮文字要变为保存,取消按钮要显示

            五. 实现点击取消按钮,编辑的各文本框清空,保存按钮变添加,取消按钮隐藏

            六. 实现点击保存,该行分类修改
                (1) 因为保存按钮和添加按钮是同一个按钮,所以用同一个点击事件,但是要根据按钮的文字是添加还是保存来进行发送添加请求还是保存请求
                (2) 发送请求,参数为各文本框中的内容
                (3) 服务器接收请求,进行数据库修改操作,返回结果
                (4) 浏览器接收到响应体,如果成功,location.reload()刷新当前页面
                

            七. 实现轮播图列表显示
                (1)与其他数据显示列表不同的是,数据库中轮播图在数组id=10的value中,注意服务器中对数据的获取
                

            八. 实现轮播图添加
               在做新增时，需要有一个图片路径的数据，如果用临时路径，那么存到数据库后下次拿到这个数据打不开这个图片
                (1)要使得轮播图的图片显示出来,要用永久路径,所以要对图片进行处理,图片预览
                   ① 给file一个值改变事件,使用FormData对象异步上传图片信息,
                   ② 服务器接收到图片信息,
                   ③ 取出图片名和临时路径
                   ④ 将图片名改为gbk格式iconv
                   ⑤ 准备目标路径
                   ⑥ 将图片存储到本地 move_upload_file
                   ⑦ 将路径给为utf-8格式
                   ⑧ 返回图片的url(urf-8格式)
                由于轮播图片在数组的value中,而value也是一个数组,数组元素即每个轮播图信息是对象
                所以,轮播图添加相当于修改value数组的元素
                (1) 声明一个全局变量list存储之前轮播图请求的响应体(即轮播图信息)
                (2) 将文本框中输入的信息用一个对象obj装起来
                (3) list是一个数组,用list.push(obj) 将新增的对象添加到list数组中
                (4) 将list数组转换为JSON字符串格式,作为请求的参数传递
                (5) 服务器接收到参数,连接数据库做修改操作
     
            */
    </script>
</body>

</html>